// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Client {
  id                String         @id @default(uuid())
  phoneNumber       String         @unique
  eventOrganizer    String
  igLink            String?
  cp1st             String?
  cp2nd             String?
  imgLogo           String?
  imgPoster         String?
  lastEvent         String?
  linkDemo          String?
  lastSystem        String?
  colorPalette      String?
  dateEstimation    DateTime?
  igeventLink       String?
  lastContact       DateTime?
  pic               String?
  status            ClientStatus   @default(TODO)
  startup           StartupType    @default(NOVAGATE)
  // New fields from Excel import
  eventType         String?
  location          String?
  nextEventDate     DateTime?
  priceRange        String?
  doneContact       Boolean        @default(false)
  notes             String?
  statistically     String?
  createdAt         DateTime       @default(now())
  updatedAt         DateTime       @updatedAt
  chatHistory       ChatHistory[]

  @@map("clients")
}

model ChatHistory {
  id         String   @id @default(uuid())
  clientId   String
  client     Client   @relation(fields: [clientId], references: [id], onDelete: Cascade)
  message    String
  isOutgoing Boolean  // true = sent by us, false = received from client
  timestamp  DateTime @default(now())

  @@map("chat_history")
  @@index([clientId])
}

model ChatTemplate {
  id          String   @id @default(uuid())
  name        String   @unique
  category    String
  message     String
  variables   String[] // Array of variables like [event_organizer], [variant_fcc]
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  @@map("chat_templates")
}

enum ClientStatus {
  TODO
  FOLLOW_UP
  NEXT_YEAR
  GHOSTED_FOLLOW_UP
}

enum StartupType {
  NOVAGATE
  NOVATIX
}
